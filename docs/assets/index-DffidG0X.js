import{r as m,G as T,j as s,V as F,F as B,t as z,u as G,$ as U,I as W,a1 as Y,a2 as q,U as J,g as K,a0 as X}from"./index-CnHM78Nl.js";import{l as R}from"./index-DoHxCD7J.js";import{g as $}from"./helper-D8J10eng.js";import{n as Q,d as Z,i as I,f as N,C as L}from"./index-DpYYvqoc.js";function O(t,e,o){const[r,a]=Q(o?.in,t,e),n=P(r,a),i=Math.abs(Z(r,a));r.setDate(r.getDate()-n*i);const l=+(P(r,a)===-n),c=n*(i-l);return c===0?0:c}function P(t,e){const o=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return o<0?-1:o>0?1:o}const w=(t,e)=>{if(t==="single"&&R.isDate(e))return N(e,"dd MMM yyyy");if(t==="single-with-time"&&R.isDate(e))return N(e,"dd MMM yyyy, HH:mm:ss");if(t==="multiple"&&e&&Array.isArray(e))return e.map(r=>N(r,"dd MMM yyyy")).join(", ");if(t==="range"&&e&&I(e)){const o=e.from,r=e.to;return o&&r?`${N(o,"dd MMM yyyy")} to ${N(r,"dd MMM yyyy")}`:""}else return""},V=(t,e)=>{e(t)},v=(t,e,o,r)=>{let a=!1,n="";if(r.isRequired&&!a&&(e||(a=!0,n="This field cannot be empty!")),r.minSelected&&!a&&(t==="multiple"||t==="range")){let i=0;t==="multiple"&&e&&Array.isArray(e)&&(i=e.length),t==="range"&&e&&I(e)&&e.from&&e.to&&(i=O(e.to,e.from)+1),i<r.minSelected&&(a=!0,n=`Value must be at least ${$(`${r.minSelected}`)} items`)}if(r.maxSelected&&!a&&(t==="multiple"||t==="range")){let i=0;t==="multiple"&&e&&Array.isArray(e)&&(i=e.length),t==="range"&&e&&I(e)&&e.from&&e.to&&(i=O(e.to,e.from)+1),i>r.maxSelected&&(a=!0,n=`Value selected cannot exceed ${$(`${r.maxSelected}`)} items`)}o({isError:a,errorMessage:n},e)},ee=t=>{t&&V(void 0,t)},te=(t,e,o,r,a,n,i,l)=>{t.stopPropagation(),n&&ee(n),i&&a&&v(e,void 0,i,a),l?.current&&l.current.focus(),o||r(!0)},se=({type:t,className:e,trigger:o,style:r=void 0,shape:a=void 0,isDisabled:n=!1,value:i,config:l,onCalendarChange:c,onClose:u,onOpen:S,elementHeader:p=void 0,elementFooter:f=void 0,floatingConfig:j=void 0})=>{const{screenSize:d}=m.useContext(T),[b,h]=m.useState(!1),g=m.useRef(null),M=m.useMemo(()=>o?typeof o=="function"?s.jsx(s.Fragment,{children:F.cloneElement(o(void 0,void 0,b,g),{ref:g,onClick:()=>{n||h(!b)},disabled:n})}):s.jsx("div",{className:B("bottom-sheet-trigger-box"),style:r?.triggerBox,children:F.cloneElement(o,{ref:g,onClick:()=>{n||h(!b)},disabled:n})}):s.jsx(s.Fragment,{}),[o,n,b]),[E,A]=m.useState(0);return m.useEffect(()=>{h(!1)},[d]),d!=="mobile"||j?.mode?.length===1&&j.mode.includes("dropdown")?s.jsx(z,{className:B("input-date-dropdown",e),trigger:o,elementHeader:p,elementFooter:f,onClose:u,onOpen:S,isDisabled:n,triggerClose:E,floatingConfig:j,shape:a,style:{container:r?.container,triggerBox:r?.triggerBox},children:s.jsx(L,{type:t,value:i,onChange:x=>{c&&c(x)},calendarStart:l?.calendarStart,calendarEnd:l?.calendarEnd,disabledDates:l?.disabledDates,isDisabled:n})}):s.jsxs(s.Fragment,{children:[M,s.jsx(G,{isOpen:b,setIsOpen:h,className:B("input-date-bottom-sheet",e),elementHeader:p,elementFooter:f,onClose:u,onOpen:S,floatingConfig:j,shape:a,style:{container:r?.container,triggerBox:r?.triggerBox},children:s.jsx(L,{type:t,value:i,onChange:x=>{c&&c(x)},calendarStart:l?.calendarStart,calendarEnd:l?.calendarEnd,disabledDates:l?.disabledDates,isDisabled:n})})]})},ae=({id:t=void 0,className:e=void 0,style:o=void 0,shape:r=void 0,afterElement:a=void 0,beforeElement:n=void 0,type:i="single",txtPlaceholder:l=void 0,value:c=void 0,isDisabled:u=!1,onChange:S=void 0,error:p=void 0,onValidate:f=void 0,triggerValidate:j=0,config:d=void 0})=>{const{globalShape:b}=m.useContext(T),[h,g]=m.useState(!1),[M,E]=m.useState(!1),A=U(()=>w(i,c),[c]),x=m.useRef(null);return m.useEffect(()=>{!h&&f&&d&&M&&v(i,c,f,d)},[JSON.stringify(c)]),m.useEffect(()=>{j===1&&!h&&f&&d&&v(i,c,f,d)},[j]),s.jsxs("div",{className:B("input-date-box",{open:h}),children:[s.jsx(se,{type:i,isDisabled:u,trigger:(C,H,D,k)=>(k.current&&(x.current=k.current),s.jsxs("div",{ref:C,...H?.()??{},role:"button",tabIndex:u?-1:0,id:t,className:B("input-date",r||b,{disabled:u,selected:D,error:p?.isError},e),style:o?.triggerButton,onKeyDown:y=>{const _=!y.target.classList.contains("clear-button");(y.keyCode===13||y.keyCode===32)&&_&&(y.preventDefault(),x.current||(x.current=k.current),x.current?.click())},children:[d?.prefixElement&&s.jsx("div",{className:"prefix-box",children:d?.prefixElement}),s.jsx("div",{className:"value-label-box",children:c?s.jsx("p",{className:"value-label",children:A}):s.jsx("span",{className:"placeholder",children:l})}),d?.sufixElement&&s.jsx("div",{className:"sufix-box",children:d?.sufixElement}),c&&!u&&d?.isShowClear&&s.jsx(W,{className:"clear-button",icon:s.jsx(Y,{}),txtLabel:"Clear",appearance:"subtle",isShowtooltip:!1,onClick:y=>{te(y,i,M,E,d,S,f,x)}}),u?s.jsx("div",{className:"lock-box",children:s.jsx(q,{className:"global-icon"})}):s.jsx("div",{className:"caret-box",children:D?s.jsx(J,{className:"global-icon"}):s.jsx(K,{className:"global-icon"})})]})),shape:r,style:o?.dropdownMenu,value:c,config:d,onCalendarChange:C=>{u||(S&&S(C),M||E(!0))},onOpen:()=>{g(!0)},onClose:()=>{g(!1),M&&f&&d&&v(i,c,f,d)},floatingConfig:{isLockScroll:!0,isContainerWidthSameAsTrigger:!1}}),n&&s.jsx("div",{className:"before-element-box",children:n}),a&&s.jsx("div",{className:"after-element-box",children:a}),p&&p.isError&&p.errorMessage&&s.jsxs("div",{className:"error-box",children:[s.jsx(X,{className:"global-icon"}),s.jsx("p",{children:p.errorMessage})]})]})};export{ae as I};
