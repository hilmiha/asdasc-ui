import{r as d,G as H,j as m,F as S,I as z,a1 as G,a2 as W,a0 as O}from"./index-BiVYdiuu.js";import{a as w,g as X}from"./helper-D8J10eng.js";import{l as Y}from"./index-D9UCkygy.js";const Z=e=>{switch(e){case"number":case"number-text":return{type:"numeric",mode:"tel"};default:return{type:"text",mode:"text"}}},V=(e,r)=>r==="number"&&e?X(e):e,J=(e,r)=>{r({isError:!1,errorMessage:""},e)},M=(e,r,c,t)=>{let s=!1,l="";if(t.isRequired&&!s&&(r||(s=!0,l="This field cannot be empty!")),t.minLength&&!s&&e!=="number"&&r.length<t.minLength&&(s=!0,l=`Minimum ${t.minLength} characters required`),t.maxLength&&!s&&e!=="number"&&r.length>t.maxLength&&(s=!0,l=`Maximum ${t.maxLength} characters allowed`),(t.maxValue!==void 0||t.minValue!==void 0)&&!s&&e==="number"){const i=w(r),a=parseInt(i??"0");t.maxValue!==void 0&&t.minValue!==void 0&&(a<t.minValue||a>t.maxValue)?(s=!0,l=`Value is out of range (${V(`${t.minValue}`,"number")} ~ ${V(`${t.maxValue}`,"number")})`):t.maxValue!==void 0&&a>t.maxValue?(s=!0,l=`Value cannot exceed ${V(`${t.maxValue}`,"number")}`):t.minValue!==void 0&&a<t.minValue&&(s=!0,l=`Value must be at least ${V(`${t.minValue}`,"number")}`)}if(t.validRegex&&!s&&e!=="number"){for(const[i,a]of t.validRegex)if(!i.test(r)){s=!0,l=a;break}}c({isError:s,errorMessage:l},r)},K=(e,r,c)=>{const t=f=>f.split("").filter(s).length,s=f=>/[a-zA-Z0-9]/.test(f),l=V(c,"number"),i=V(r,"number"),b=(e.selectionStart??0)-1;if(b>=i.length){const f=l.length;e.setSelectionRange(f,f);return}const x=i.slice(0,b),n=t(x);let u=0,j=0;for(;u<l.length&&(s(l[u])&&j++,!(j>=n+2));u++);requestAnimationFrame(()=>{e.setSelectionRange(u,u)})},Q=(e,r,c,t,s,l,i,a,b,x)=>{const n=e.target.value;let u=n;switch(c){case"text-no-space":u=n.replace(/\s/g,"");break;case"number-text":u=n.replace(/[^0-9]/g,"");break;case"number":u=w(n);break;case"text":default:u=n;break}a?.isAllowBreakline===!1&&(u=u.replaceAll(/\n/g,"")),a?.maxLength&&(u=u.slice(0,a.maxLength)),t(u),i(u,e),x&&b?.isError&&J(u,x),c==="number"&&K(e.target,r,u),s||l(!0)},U=(e,r,c,t,s,l,i,a,b)=>{let n=e.target.value.trim();c==="number"&&(n=w(n)),r!==n&&(t(n),l(n,e)),a&&s&&i&&M(c,n,a,i),b&&b(e,n)},_=(e,r,c)=>{c&&c(e,r)},D=(e,r,c,t,s,l,i)=>{c(""),t("",e),l&&s&&M(r,"",l,s),i?.current&&i.current.focus()},ee=(e,r,c,t)=>{const s=e.current;if(!s||r==null)return;s.style.height="auto";const l=s.scrollHeight,i=Math.round(l/r),a=Math.min(Math.max(c,i),t);s.style.overflowY=i>t?"auto":"hidden",s.style.height=`${a*r}px`},ae=({ref:e=void 0,id:r=void 0,className:c=void 0,style:t=void 0,shape:s=void 0,afterElement:l=void 0,beforeElement:i=void 0,type:a="text",txtPlaceholder:b=void 0,value:x="",isDisabled:n=!1,onChange:u=void 0,onBlur:j=void 0,onFocus:f=void 0,error:C=void 0,onValidate:v=void 0,triggerValidate:F=0,config:o=void 0})=>{const{globalShape:A}=d.useContext(H),[L,N]=d.useState(x),[$,T]=d.useState(!1),[P,R]=d.useState(!1),g=d.useMemo(()=>Z(a),[a]),p=d.useRef(null);d.useEffect(()=>{e&&p.current&&(typeof e=="function"?e(p.current):e.current!==void 0&&(e.current=p.current))},[e]);const k=d.useCallback(Y.debounce((h,E)=>{u&&u(h,E)},300),[u]);d.useEffect(()=>{x!==L&&!P&&(N(x),v&&o&&$&&M(a,x,v,o))},[x]),d.useEffect(()=>{F===1&&v&&o&&M(a,x,v,o)},[F]);const[I,q]=d.useState(0),B=d.useMemo(()=>o?.initialLines??2,[o?.initialLines]),y=d.useMemo(()=>o?.maxLines??4,[o?.maxLines]);return d.useEffect(()=>{if(p.current&&I===0){const h=window.getComputedStyle(p.current),E=parseFloat(h.lineHeight);isNaN(E)||q(E)}},[]),d.useEffect(()=>{ee(p,I,B,y)},[L,I,y,B]),m.jsxs("div",{className:S("input-textarea-box",c),children:[m.jsxs("div",{className:S("input-textarea-container",s||A,{disabled:n,error:C?.isError}),onClick:()=>{p.current?.focus()},children:[o?.prefixElement&&m.jsx("div",{className:"prefix-box",children:o?.prefixElement}),m.jsx("textarea",{id:r,ref:p,className:S("input-textarea"),style:t?.input,placeholder:b,value:V(L,a),onChange:h=>{n||Q(h,x,a,N,$,T,k,o,C,v)},onBlur:h=>{n||U(h,x,a,N,$,k,o,v,j),R(!1)},onFocus:h=>{n||_(h,x,f),R(!0)},rows:1,disabled:n,inputMode:g.mode}),o?.sufixElement&&m.jsx("div",{className:"sufix-box",children:o?.sufixElement}),o?.isWithCounter&&!n&&m.jsx("div",{children:m.jsx("p",{className:"text-sub text-sm",children:`${L.length}${o.maxLength?` / ${o.maxLength}`:""}`})}),L.length>0&&!n&&o?.isShowClear&&m.jsx(z,{className:"clear-button",icon:m.jsx(G,{}),txtLabel:"Clear",appearance:"subtle",isShowtooltip:!1,onClick:h=>{D(h,a,N,k,o,v,p)}}),n&&m.jsx("div",{className:"lock-box",children:m.jsx(W,{className:"global-icon"})})]}),i&&m.jsx("div",{className:"before-element-box",children:i}),l&&m.jsx("div",{className:"after-element-box",children:l}),C&&C.isError&&C.errorMessage&&m.jsxs("div",{className:"error-box",children:[m.jsx(O,{className:"global-icon"}),m.jsx("p",{children:C.errorMessage})]})]})};export{ae as I};
