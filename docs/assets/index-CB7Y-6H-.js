import{r as m,G as O,j as s,ah as k,c as y,f as z,d as U,am as _,I as G,an as W,ao as Y,P as q,a as J,H as K}from"./index-CE2XMQiS.js";import{l as F}from"./index-BcdltFkS.js";import{g as A}from"./helper-cZjCkDdV.js";import{n as X,d as Q,i as C,f as M,C as H}from"./index-CRzr2afz.js";function P(t,e,o){const[r,a]=X(o?.in,t,e),i=R(r,a),n=Math.abs(Q(r,a));r.setDate(r.getDate()-i*n);const c=+(R(r,a)===-i),d=i*(n-c);return d===0?0:d}function R(t,e){const o=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return o<0?-1:o>0?1:o}const Z=(t,e)=>{if(t==="single"&&F.isDate(e))return M(e,"dd MMM yyyy");if(t==="single-with-time"&&F.isDate(e))return M(e,"dd MMM yyyy, HH:mm:ss");if(t==="multiple"&&e&&Array.isArray(e))return e.map(r=>M(r,"dd MMM yyyy")).join(", ");if(t==="range"&&e&&C(e)){const o=e.from,r=e.to;return o&&r?`${M(o,"dd MMM yyyy")} to ${M(r,"dd MMM yyyy")}`:""}else return""},w=(t,e)=>{e(t)},D=(t,e,o,r)=>{let a=!1,i="";if(r.isRequired&&!a&&(e||(a=!0,i="This field cannot be empty!")),r.minSelected&&!a&&(t==="multiple"||t==="range")){let n=0;t==="multiple"&&e&&Array.isArray(e)&&(n=e.length),t==="range"&&e&&C(e)&&e.from&&e.to&&(n=P(e.to,e.from)+1),n<r.minSelected&&(a=!0,i=`Value must be at least ${A(`${r.minSelected}`)} items`)}if(r.maxSelected&&!a&&(t==="multiple"||t==="range")){let n=0;t==="multiple"&&e&&Array.isArray(e)&&(n=e.length),t==="range"&&e&&C(e)&&e.from&&e.to&&(n=P(e.to,e.from)+1),n>r.maxSelected&&(a=!0,i=`Value selected cannot exceed ${A(`${r.maxSelected}`)} items`)}o({isError:a,errorMessage:i},e)},V=t=>{t&&w(void 0,t)},ee=(t,e,o,r,a,i,n,c)=>{t.stopPropagation(),i&&V(i),n&&a&&D(e,void 0,n,a),c?.current&&c.current.focus(),o||r(!0)},te=({type:t,className:e,trigger:o,style:r=void 0,shape:a=void 0,isDisabled:i=!1,value:n,config:c,onCalendarChange:d,onClose:f,onOpen:b,elementHeader:x=void 0,elementFooter:u=void 0,floatingConfig:l=void 0})=>{const{screenSize:N}=m.useContext(O),[p,h]=m.useState(!1),g=m.useRef(null),B=m.useMemo(()=>o?typeof o=="function"?s.jsx(s.Fragment,{children:k.cloneElement(o(void 0,void 0,p,g),{ref:g,onClick:()=>{i||h(!p)},disabled:i})}):s.jsx("div",{className:y("bottom-sheet-trigger-box"),style:r?.triggerBox,children:k.cloneElement(o,{ref:g,onClick:()=>{i||h(!p)},disabled:i})}):s.jsx(s.Fragment,{}),[o,i,p]),[v,E]=m.useState(0);return m.useEffect(()=>{h(!1)},[N]),N!=="mobile"||l?.mode?.length===1&&l.mode.includes("dropdown")?s.jsx(z,{className:y("input-date-dropdown",e),trigger:o,elementHeader:x,elementFooter:u,onClose:f,onOpen:b,isDisabled:i,triggerClose:v,floatingConfig:l,shape:a,style:{container:r?.container,triggerBox:r?.triggerBox},children:s.jsx(H,{type:t,value:n,onChange:j=>{d&&d(j)},calendarStart:c?.calendarStart,calendarEnd:c?.calendarEnd,disabledDates:c?.disabledDates,isDisabled:i})}):s.jsxs(s.Fragment,{children:[B,s.jsx(U,{isOpen:p,setIsOpen:h,className:y("input-date-bottom-sheet",e),elementHeader:x,elementFooter:u,onClose:f,onOpen:b,floatingConfig:{...l,snapPointSize:t==="single-with-time"?{HIDDEN:0,HALF:65,FULL:80}:{HIDDEN:0,HALF:55,FULL:80}},shape:a,style:{container:r?.container,triggerBox:r?.triggerBox},children:s.jsx(H,{type:t,value:n,onChange:j=>{d&&d(j)},calendarStart:c?.calendarStart,calendarEnd:c?.calendarEnd,disabledDates:c?.disabledDates,isDisabled:i})})]})},ne=({id:t=void 0,className:e=void 0,style:o=void 0,shape:r=void 0,afterElement:a=void 0,beforeElement:i=void 0,type:n="single",txtPlaceholder:c=void 0,value:d=void 0,isDisabled:f=!1,onChange:b=void 0,error:x=void 0,onValidate:u=void 0,config:l=void 0})=>{const{globalShape:N}=m.useContext(O),[p,h]=m.useState(!1),[g,B]=m.useState(!1),v=_(()=>Z(n,d),[d]),E=m.useRef(null);return m.useEffect(()=>{!p&&u&&l&&g&&D(n,d,u,l)},[JSON.stringify(d)]),s.jsxs("div",{className:y("input-date-box",{open:p}),children:[s.jsx(te,{type:n,isDisabled:f,trigger:(j,$,I,L)=>(L.current&&(E.current=L.current),s.jsxs("div",{ref:j,...$?.()??{},role:"button",tabIndex:f?-1:0,id:t,className:y("input-date",r||N,{disabled:f,selected:I,error:x?.isError},e),style:o?.triggerButton,onKeyDown:S=>{const T=!S.target.classList.contains("clear-button");(S.keyCode===13||S.keyCode===32)&&T&&(S.preventDefault(),E.current?.click())},children:[l?.prefixElement&&s.jsx("div",{className:"prefix-box",children:l?.prefixElement}),s.jsx("div",{className:"value-label-box",children:d?s.jsx("p",{className:"value-label",children:v}):s.jsx("span",{className:"placeholder",children:c})}),l?.sufixElement&&s.jsx("div",{className:"sufix-box",children:l?.sufixElement}),d&&!f&&!l?.isHideClear&&s.jsx(G,{className:"clear-button",icon:s.jsx(W,{}),txtLabel:"Clear",appearance:"subtle",isShowtooltip:!1,onClick:S=>{ee(S,n,g,B,l,b,u,E)}}),f?s.jsx("div",{className:"lock-box",children:s.jsx(Y,{className:"global-icon"})}):s.jsx("div",{className:"caret-box",children:I?s.jsx(q,{className:"global-icon"}):s.jsx(J,{className:"global-icon"})})]})),shape:r,style:o?.dropdownMenu,value:d,config:l,onCalendarChange:j=>{f||(b&&b(j),g||B(!0))},onOpen:()=>{h(!0)},onClose:()=>{h(!1),g&&u&&l&&D(n,d,u,l)},floatingConfig:{isLockScroll:!0,isContainerWidthSameAsTrigger:!1}}),i&&s.jsx("div",{className:"before-element-box",children:i}),a&&s.jsx("div",{className:"after-element-box",children:a}),x&&x.isError&&x.errorMessage&&s.jsxs("div",{className:"error-box",children:[s.jsx(K,{className:"global-icon"}),s.jsx("p",{children:x.errorMessage})]})]})};export{ne as I};
