import{r as d,G as P,j as x,c as I,I as q,ak as z,al as G,F as O}from"./index-C5u07D6-.js";import{a as S,g as W}from"./helper-cZjCkDdV.js";import{l as X}from"./index-D6UgoieT.js";const Y=e=>{switch(e){case"number":case"number-text":return{type:"numeric",mode:"tel"};default:return{type:"text",mode:"text"}}},V=(e,r)=>r==="number"&&e?W(e):e,Z=(e,r)=>{r({isError:!1,errorMessage:""},e)},$=(e,r,o,t)=>{let s=!1,a="";if(t.isRequired&&!s&&(r||(s=!0,a="This field cannot be empty!")),t.minLength&&!s&&e!=="number"&&r.length<t.minLength&&(s=!0,a=`Minimum ${t.minLength} characters required`),t.maxLength&&!s&&e!=="number"&&r.length>t.maxLength&&(s=!0,a=`Maximum ${t.maxLength} characters allowed`),(t.maxValue!==void 0||t.minValue!==void 0)&&!s&&e==="number"){const u=S(r),l=parseInt(u??"0");t.maxValue!==void 0&&t.minValue!==void 0&&(l<t.minValue||l>t.maxValue)?(s=!0,a=`Value is out of range (${V(`${t.minValue}`,"number")} ~ ${V(`${t.maxValue}`,"number")})`):t.maxValue!==void 0&&l>t.maxValue?(s=!0,a=`Value cannot exceed ${V(`${t.maxValue}`,"number")}`):t.minValue!==void 0&&l<t.minValue&&(s=!0,a=`Value must be at least ${V(`${t.minValue}`,"number")}`)}if(t.validRegex&&!s&&e!=="number"){for(const[u,l]of t.validRegex)if(!u.test(r)){s=!0,a=l;break}}o({isError:s,errorMessage:a},r)},D=(e,r,o)=>{const t=f=>f.split("").filter(s).length,s=f=>/[a-zA-Z0-9]/.test(f),a=V(o,"number"),u=V(r,"number"),b=(e.selectionStart??0)-1;if(b>=u.length){const f=a.length;e.setSelectionRange(f,f);return}const c=u.slice(0,b),n=t(c);let i=0,C=0;for(;i<a.length&&(s(a[i])&&C++,!(C>=n+2));i++);requestAnimationFrame(()=>{e.setSelectionRange(i,i)})},J=(e,r,o,t,s,a,u,l,b,c)=>{const n=e.target.value;let i=n;switch(o){case"text-no-space":i=n.replace(/\s/g,"");break;case"number-text":i=n.replace(/[^0-9]/g,"");break;case"number":i=S(n);break;case"text":default:i=n;break}l?.isAllowBreakline===!1&&(i=i.replaceAll(/\n/g,"")),l?.maxLength&&(i=i.slice(0,l.maxLength)),t(i),u(i,e),c&&b?.isError&&Z(i,c),o==="number"&&D(e.target,r,i),s||a(!0)},K=(e,r,o,t,s,a,u,l,b)=>{let n=e.target.value.trim();o==="number"&&(n=S(n)),r!==n&&(t(n),a(n,e)),l&&s&&u&&$(o,n,l,u),b&&b(e,n)},Q=(e,r,o)=>{o&&o(e,r)},U=(e,r,o,t,s,a,u)=>{o(""),t("",e),a&&s&&$(r,"",a,s),u?.current&&u.current.focus()},_=(e,r,o,t)=>{const s=e.current;if(!s||r==null)return;s.style.height="auto";const a=s.scrollHeight,u=Math.round(a/r),l=Math.min(Math.max(o,u),t);s.style.overflowY=u>t?"auto":"hidden",s.style.height=`${l*r}px`},re=({ref:e=void 0,id:r=void 0,className:o=void 0,style:t=void 0,shape:s=void 0,afterElement:a=void 0,beforeElement:u=void 0,type:l="text",txtPlaceholder:b=void 0,value:c="",isDisabled:n=!1,onChange:i=void 0,onBlur:C=void 0,onFocus:f=void 0,error:v=void 0,onValidate:j=void 0,config:m=void 0})=>{const{globalShape:B}=d.useContext(P),[M,L]=d.useState(c),[F,y]=d.useState(!1),[A,R]=d.useState(!1),T=d.useMemo(()=>Y(l),[l]),p=d.useRef(null);d.useEffect(()=>{e&&p.current&&(typeof e=="function"?e(p.current):e.current!==void 0&&(e.current=p.current))},[e]);const k=d.useCallback(X.debounce((h,N)=>{i&&i(h,N)},300),[i]);d.useEffect(()=>{c!==M&&!A&&(L(c),j&&m&&$(l,c,j,m))},[c]);const[E,H]=d.useState(0),w=d.useMemo(()=>m?.initialLines??2,[m?.initialLines]),g=d.useMemo(()=>m?.maxLines??4,[m?.maxLines]);return d.useEffect(()=>{if(p.current&&E===0){const h=window.getComputedStyle(p.current),N=parseFloat(h.lineHeight);isNaN(N)||H(N)}},[]),d.useEffect(()=>{_(p,E,w,g)},[M,E,g,w]),x.jsxs("div",{className:I("input-textarea-box",o),children:[x.jsxs("div",{className:I("input-textarea-container",s||B,{disabled:n,error:v?.isError}),onClick:()=>{p.current?.focus()},children:[m?.prefixElement&&x.jsx("div",{className:"prefix-box",children:m?.prefixElement}),x.jsx("textarea",{id:r,ref:p,className:I("input-textarea"),style:t?.input,placeholder:b,value:V(M,l),onChange:h=>{n||J(h,c,l,L,F,y,k,m,v,j)},onBlur:h=>{n||K(h,c,l,L,F,k,m,j,C),R(!1)},onFocus:h=>{n||Q(h,c,f),R(!0)},rows:1,disabled:n,inputMode:T.mode}),m?.sufixElement&&x.jsx("div",{className:"sufix-box",children:m?.sufixElement}),c.length>0&&!n&&!m?.isHideClear&&x.jsx(q,{className:"clear-button",icon:x.jsx(z,{}),txtLabel:"Clear",appearance:"subtle",isShowtooltip:!1,onClick:h=>{U(h,l,L,k,m,j,p)}}),n&&x.jsx("div",{className:"lock-box",children:x.jsx(G,{className:"global-icon"})})]}),u&&x.jsx("div",{className:"before-element-box",children:u}),a&&x.jsx("div",{className:"after-element-box",children:a}),v&&v.isError&&v.errorMessage&&x.jsxs("div",{className:"error-box",children:[x.jsx(O,{className:"global-icon"}),x.jsx("p",{children:v.errorMessage})]})]})};export{re as I};
