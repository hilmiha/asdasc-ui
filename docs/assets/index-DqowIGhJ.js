import{r as b,G as q,j as c,F as $,I as A,a1 as T,a2 as W,a0 as G}from"./index-CnHM78Nl.js";import{a as M,g as z}from"./helper-D8J10eng.js";import{l as D}from"./index-DoHxCD7J.js";const K=e=>{switch(e){case"number":case"tel":case"number-text":return{type:"numeric",mode:"tel"};case"password":return{type:"password",mode:"text"};default:return{type:"text",mode:"text"}}},v=(e,l)=>l==="number"&&e?z(e):e,O=(e,l)=>{l({isError:!1,errorMessage:""},e)},E=(e,l,i,t)=>{let r=!1,u="";if(t.isRequired&&!r&&(l||(r=!0,u="This field cannot be empty!")),t.minLength&&!r&&e!=="number"&&l.length<t.minLength&&(r=!0,u=`Minimum ${t.minLength} characters required`),t.maxLength&&!r&&e!=="number"&&l.length>t.maxLength&&(r=!0,u=`Maximum ${t.maxLength} characters allowed`),(t.maxValue!==void 0||t.minValue!==void 0)&&!r&&e==="number"){const o=M(l),n=parseInt(o??"0");t.maxValue!==void 0&&t.minValue!==void 0&&(n<t.minValue||n>t.maxValue)?(r=!0,u=`Value is out of range (${v(`${t.minValue}`,"number")} ~ ${v(`${t.maxValue}`,"number")})`):t.maxValue!==void 0&&n>t.maxValue?(r=!0,u=`Value cannot exceed ${v(`${t.maxValue}`,"number")}`):t.minValue!==void 0&&n<t.minValue&&(r=!0,u=`Value must be at least ${v(`${t.minValue}`,"number")}`)}if(t.validRegex&&!r&&e!=="number"){for(const[o,n]of t.validRegex)if(!o.test(l)){r=!0,u=n;break}}i({isError:r,errorMessage:u},l)},X=(e,l,i)=>{const t=p=>p.split("").filter(r).length,r=p=>/[a-zA-Z0-9]/.test(p),u=v(i,"number"),o=v(l,"number"),h=(e.selectionStart??0)-1;if(h>=o.length){const p=u.length;e.setSelectionRange(p,p);return}const m=o.slice(0,h),s=t(m);let a=0,C=0;for(;a<u.length&&(r(u[a])&&C++,!(C>=s+2));a++);requestAnimationFrame(()=>{e.setSelectionRange(a,a)})},Z=(e,l,i,t,r,u,o,n,h,m)=>{const s=e.target.value;let a=s;switch(i){case"text-no-space":a=s.replace(/\s/g,"");break;case"number-text":a=s.replace(/[^0-9]/g,"");break;case"tel":s.length===0?a="":s.startsWith("+")?a="+"+a.slice(1).replace(/\D/g,""):a="+"+a.replace(/\D/g,"");break;case"number":a=M(s);break;case"text":case"password":default:a=s;break}n?.maxLength&&(a=a.slice(0,n.maxLength)),t(a),o(a,e),m&&h?.isError&&O(a,m),i==="number"&&X(e.target,l,a),r||u(!0)},H=(e,l,i,t,r,u,o,n,h)=>{let s=e.target.value.trim();i==="number"&&(s=M(s)),i==="tel"&&s==="+"&&(s=""),l!==s&&(t(s),u(s,e)),n&&r&&o&&E(i,s,n,o),h&&h(e,s)},J=(e,l,i)=>{i&&i(e,l)},Q=(e,l,i,t,r,u,o)=>{i(""),t("",e),u&&r&&E(l,"",u,r),o?.current&&o.current.focus()},U=(e,l,i)=>{i&&i(e,l)},te=({ref:e=void 0,id:l=void 0,className:i=void 0,style:t=void 0,shape:r=void 0,afterElement:u=void 0,beforeElement:o=void 0,type:n="text",txtPlaceholder:h=void 0,value:m="",isDisabled:s=!1,onChange:a=void 0,onBlur:C=void 0,onFocus:p=void 0,onKeyDown:R=void 0,error:V=void 0,onValidate:f=void 0,triggerValidate:S=0,config:x=void 0})=>{const{globalShape:B}=b.useContext(q),[N,k]=b.useState(m),[I,g]=b.useState(!1),[y,w]=b.useState(!1),F=b.useMemo(()=>K(n),[n]),j=b.useRef(null);b.useEffect(()=>{e&&j.current&&(typeof e=="function"?e(j.current):e.current!==void 0&&(e.current=j.current))},[e]);const L=b.useCallback(D.debounce((d,P)=>{a&&a(d,P)},300),[a]);return b.useEffect(()=>{m!==N&&!y&&(k(m),f&&x&&I&&E(n,m,f,x))},[m]),b.useEffect(()=>{S===1&&f&&x&&E(n,m,f,x)},[S]),c.jsxs("div",{className:$("input-text-box",i),children:[c.jsxs("div",{className:$("input-text-container",r||B,{disabled:s,error:V?.isError}),onClick:()=>{j.current?.focus()},children:[x?.prefixElement&&c.jsx("div",{className:"prefix-box",children:x?.prefixElement}),c.jsx("input",{id:l,ref:j,className:$("input-text"),style:t?.input,placeholder:h,value:v(N,n),onChange:d=>{s||Z(d,m,n,k,I,g,L,x,V,f)},onBlur:d=>{s||H(d,m,n,k,I,L,x,f,C),w(!1)},onFocus:d=>{s||J(d,m,p),w(!0)},onKeyDown:d=>{s||U(d,N,R)},disabled:s,type:F.type,inputMode:F.mode}),x?.sufixElement&&c.jsx("div",{className:"sufix-box",children:x?.sufixElement}),x?.isWithCounter&&!s&&c.jsx("div",{children:c.jsx("p",{className:"text-sub text-sm",children:`${N.length}${x.maxLength?` / ${x.maxLength}`:""}`})}),N.length>0&&!s&&x?.isShowClear&&c.jsx(A,{className:"clear-button",icon:c.jsx(T,{}),txtLabel:"Clear",appearance:"subtle",isShowtooltip:!1,onClick:d=>{Q(d,n,k,L,x,f,j)}}),s&&c.jsx("div",{className:"lock-box",children:c.jsx(W,{className:"global-icon"})})]}),o&&c.jsx("div",{className:"before-element-box",children:o}),u&&c.jsx("div",{className:"after-element-box",children:u}),V&&V.isError&&V.errorMessage&&c.jsxs("div",{className:"error-box",children:[c.jsx(G,{className:"global-icon"}),c.jsx("p",{children:V.errorMessage})]})]})};export{te as I};
